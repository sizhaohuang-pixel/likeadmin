# 小号列表搜索功能说明

## 功能概述

小号列表现在支持多种搜索条件，包括按运营（客服）姓名或账号进行搜索。

## 支持的搜索字段

### 1. 精确搜索字段
- `nickname` - 小号昵称
- `area_code` - 区号
- `phone` - 电话号码
- `password` - 密码
- `mid` - 自定义ID
- `status` - 状态
- `group_id` - 分组ID
- `operator_id` - 运营ID

### 2. 模糊搜索字段
- `operator_name` - 运营姓名/账号（支持模糊搜索）

## API使用示例

### 基础搜索
```http
GET /adminapi/alt_account/lists?page=1&limit=20&nickname=测试&status=1
```

### 按分组搜索
```http
GET /adminapi/alt_account/lists?page=1&limit=20&group_id=5
```

### 按运营搜索
```http
GET /adminapi/alt_account/lists?page=1&limit=20&operator_name=张三
```

### 组合搜索
```http
GET /adminapi/alt_account/lists?page=1&limit=20&status=1&operator_name=客服&group_id=3
```

## 运营搜索特性

### 搜索范围
- **姓名搜索**: 搜索Admin表中的`name`字段
- **账号搜索**: 搜索Admin表中的`account`字段
- **模糊匹配**: 支持部分匹配，如搜索"张"可以找到"张三"

### 搜索逻辑
```sql
-- 运营姓名搜索的SQL逻辑
LEFT JOIN la_admin admin ON la_alt_account.operator_id = admin.id
WHERE (admin.name LIKE '%搜索词%' OR admin.account LIKE '%搜索词%')
```

## 返回数据格式

```json
{
    "code": 200,
    "msg": "成功",
    "data": {
        "lists": [
            {
                "id": 1,
                "tenant_id": 123,
                "group_id": 5,
                "operator_id": 10,
                "avatar": "头像URL",
                "nickname": "小号昵称",
                "area_code": "86",
                "phone": "13800138000",
                "password": "密码",
                "mid": "自定义ID",
                "status": 1,
                "group_name": "分组名称",
                "operator_name": "张三(zhangsan)"
            }
        ],
        "count": 100,
        "page": 1,
        "limit": 20
    }
}
```

## 前端开发指南

### 搜索表单字段
```html
<!-- 基础搜索 -->
<input name="nickname" placeholder="小号昵称" />
<input name="phone" placeholder="电话号码" />
<select name="status">
    <option value="">全部状态</option>
    <option value="0">封禁</option>
    <option value="1">正常</option>
    <option value="2">下线</option>
</select>

<!-- 分组搜索 -->
<select name="group_id">
    <option value="">全部分组</option>
    <option value="0">未分组</option>
    <!-- 动态加载分组选项 -->
</select>

<!-- 运营搜索 -->
<input name="operator_name" placeholder="客服姓名或账号" />
<select name="operator_id">
    <option value="">全部客服</option>
    <!-- 动态加载运营选项 -->
</select>
```

### 搜索提示
- **运营搜索**: 可以输入运营的姓名或账号进行模糊搜索
- **分组搜索**: 可以选择特定分组或"未分组"
- **状态搜索**: 0-封禁，1-正常，2-下线
- **组合搜索**: 支持多个条件同时搜索

## 技术实现要点

### 1. 关联查询
- 使用LEFT JOIN关联Admin表
- 避免因运营不存在导致小号数据丢失

### 2. 搜索优化
- 运营姓名搜索使用OR条件（姓名或账号）
- 保持原有的精确搜索功能不变

### 3. 数据一致性
- 列表查询和数量统计使用相同的搜索逻辑
- 确保分页数据准确

## 注意事项

1. **性能考虑**: 运营姓名搜索会使用关联查询，建议为Admin表的name和account字段添加索引
2. **权限控制**: 搜索结果仍然受租户权限控制，只能搜索自己的小号
3. **数据显示**: 运营姓名显示格式为"姓名(账号)"或"账号"

## 索引建议

```sql
-- 为Admin表添加搜索索引
ALTER TABLE `la_admin` ADD INDEX `idx_name` (`name`);
ALTER TABLE `la_admin` ADD INDEX `idx_account` (`account`);

-- 为AltAccount表添加搜索索引
ALTER TABLE `la_alt_account` ADD INDEX `idx_nickname` (`nickname`);
ALTER TABLE `la_alt_account` ADD INDEX `idx_phone` (`phone`);
```
